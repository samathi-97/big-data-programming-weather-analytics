{
  "paragraphs": [
    {
      "text": "%pyspark\n#Load and prepare the data\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.sql import SparkSession\nfrom pyspark.ml.regression import LinearRegression\nfrom pyspark.ml.regression import RandomForestRegressor\nfrom pyspark.ml.regression import DecisionTreeRegressor\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.sql import Row\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\nfrom pyspark.sql.functions import when, col, to_date, month, year\nfrom pyspark.sql import functions as F",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:45+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123797631_1867457466",
      "id": "paragraph_1765123797631_1867457466",
      "dateCreated": "2025-12-07T16:09:57+0000",
      "dateStarted": "2025-12-17T19:20:45+0000",
      "dateFinished": "2025-12-17T19:20:45+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:1013352"
    },
    {
      "text": "%pyspark\n#Creating the spark session \nspark = SparkSession.builder \\\n    .appName(\"EvapotranspirationModel\") \\\n    .getOrCreate()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:46+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765171457325_234743872",
      "id": "paragraph_1765171457325_234743872",
      "dateCreated": "2025-12-08T05:24:17+0000",
      "dateStarted": "2025-12-17T19:20:46+0000",
      "dateFinished": "2025-12-17T19:20:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013353"
    },
    {
      "text": "%pyspark\npath = \"/data/weatherData.csv\"\ndf = spark.read.csv(path, header=True, inferSchema=True)\ndf.show(3)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:46+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+--------+-----------------------+-----------------------+-----------------------+------------------------+-----------------------------+-----------------------------+------------------------------+---------------------+---------------------+----------------------+-------------+-----------------------+-------------------------+-------------------------+-------------------------------+-------------------------------+-------------------------------+-------+------+\n|location_id|    date|weather_code (wmo code)|temperature_2m_max (°C)|temperature_2m_min (°C)|temperature_2m_mean (°C)|apparent_temperature_max (°C)|apparent_temperature_min (°C)|apparent_temperature_mean (°C)|daylight_duration (s)|sunshine_duration (s)|precipitation_sum (mm)|rain_sum (mm)|precipitation_hours (h)|wind_speed_10m_max (km/h)|wind_gusts_10m_max (km/h)|wind_direction_10m_dominant (°)|shortwave_radiation_sum (MJ/m²)|et0_fao_evapotranspiration (mm)|sunrise|sunset|\n+-----------+--------+-----------------------+-----------------------+-----------------------+------------------------+-----------------------------+-----------------------------+------------------------------+---------------------+---------------------+----------------------+-------------+-----------------------+-------------------------+-------------------------+-------------------------------+-------------------------------+-------------------------------+-------+------+\n|          0|1/1/2010|                      1|                   30.1|                   22.6|                    26.0|                         34.5|                         25.0|                          29.0|              42220.2|             38905.73|                   0.0|          0.0|                      0|                     12.2|                     27.4|                             19|                          20.92|                           4.61|  06:22| 18:05|\n|          0|1/2/2010|                     51|                   30.1|                   23.7|                    26.3|                         33.9|                         26.1|                          29.7|             42225.71|             37451.01|                   0.1|          0.1|                      1|                     13.0|                     27.0|                             24|                          17.71|                           3.91|  06:22| 18:06|\n|          0|1/3/2010|                     51|                   29.6|                   23.1|                    26.0|                         34.5|                         26.2|                          29.9|             42231.68|             33176.43|                   0.6|          0.6|                      3|                     12.3|                     27.4|                             17|                          17.76|                           3.66|  06:22| 18:06|\n+-----------+--------+-----------------------+-----------------------+-----------------------+------------------------+-----------------------------+-----------------------------+------------------------------+---------------------+---------------------+----------------------+-------------+-----------------------+-------------------------+-------------------------+-------------------------------+-------------------------------+-------------------------------+-------+------+\nonly showing top 3 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1693",
              "$$hashKey": "object:1013753"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1694",
              "$$hashKey": "object:1013754"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1695",
              "$$hashKey": "object:1013755"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123585943_432271149",
      "id": "paragraph_1765123585943_432271149",
      "dateCreated": "2025-12-07T16:06:25+0000",
      "dateStarted": "2025-12-17T19:20:46+0000",
      "dateFinished": "2025-12-17T19:20:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013354"
    },
    {
      "text": "%pyspark\n# Remove rows with missing values\ndf = df.dropna()\n\n# Remove duplicates\ndf = df.dropDuplicates()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765171612856_458720068",
      "id": "paragraph_1765171612856_458720068",
      "dateCreated": "2025-12-08T05:26:52+0000",
      "dateStarted": "2025-12-17T19:20:47+0000",
      "dateFinished": "2025-12-17T19:20:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013355"
    },
    {
      "text": "%pyspark\n\n\ndf = df.withColumn(\n    \"date_clean\",\n    when(col(\"date\") == \"\", None).otherwise(col(\"date\"))\n)\n\ndf = df.withColumn(\n    \"date_parsed\",\n    to_date(col(\"date_clean\"), \"M/d/yy\")\n)\n\ndf = df.withColumn(\"month\", month(col(\"date_parsed\"))) \\\n       .withColumn(\"year\",  year(col(\"date_parsed\")))\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765124688693_655872489",
      "id": "paragraph_1765124688693_655872489",
      "dateCreated": "2025-12-07T16:24:48+0000",
      "dateStarted": "2025-12-17T19:20:47+0000",
      "dateFinished": "2025-12-17T19:20:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013356"
    },
    {
      "text": "%pyspark\n#Filter for month of May\nmay_df = df.filter(col(\"month\") == 5)\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123532085_27180025",
      "id": "paragraph_1765123532085_27180025",
      "dateCreated": "2025-12-07T16:05:32+0000",
      "dateStarted": "2025-12-17T19:20:47+0000",
      "dateFinished": "2025-12-17T19:20:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013357"
    },
    {
      "text": "%pyspark\nmay_df.show(5)\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:48+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+---------+-----------------------+-----------------------+-----------------------+------------------------+-----------------------------+-----------------------------+------------------------------+---------------------+---------------------+----------------------+-------------+-----------------------+-------------------------+-------------------------+-------------------------------+-------------------------------+-------------------------------+-------+------+----------+-----------+-----+----+\n|location_id|     date|weather_code (wmo code)|temperature_2m_max (°C)|temperature_2m_min (°C)|temperature_2m_mean (°C)|apparent_temperature_max (°C)|apparent_temperature_min (°C)|apparent_temperature_mean (°C)|daylight_duration (s)|sunshine_duration (s)|precipitation_sum (mm)|rain_sum (mm)|precipitation_hours (h)|wind_speed_10m_max (km/h)|wind_gusts_10m_max (km/h)|wind_direction_10m_dominant (°)|shortwave_radiation_sum (MJ/m²)|et0_fao_evapotranspiration (mm)|sunrise|sunset|date_clean|date_parsed|month|year|\n+-----------+---------+-----------------------+-----------------------+-----------------------+------------------------+-----------------------------+-----------------------------+------------------------------+---------------------+---------------------+----------------------+-------------+-----------------------+-------------------------+-------------------------+-------------------------------+-------------------------------+-------------------------------+-------+------+----------+-----------+-----+----+\n|          0|5/24/2012|                     63|                   29.0|                   24.9|                    26.6|                         34.2|                         28.9|                          31.3|             44903.81|             35737.93|                   9.9|          9.9|                     18|                     17.8|                     43.6|                            222|                          17.75|                           3.48|  05:53| 18:21| 5/24/2012| 2012-05-24|    5|2012|\n|          0| 5/3/2013|                     63|                   28.3|                   25.3|                    26.3|                         33.4|                         30.7|                          31.7|             44560.68|             11805.73|                  18.5|         18.5|                     19|                     15.5|                     35.3|                            237|                           10.1|                            2.1|  05:55| 18:18|  5/3/2013| 2013-05-03|    5|2013|\n|          0|5/11/2018|                     63|                   29.4|                   23.8|                    26.8|                         35.5|                         28.0|                          31.9|             44700.87|             32655.86|                  14.2|         14.2|                      9|                     13.2|                     28.4|                            177|                           16.9|                           3.38|  05:54| 18:19| 5/11/2018| 2018-05-11|    5|2018|\n|          1| 5/7/2010|                     61|                   31.1|                   25.7|                    27.5|                         37.5|                         31.3|                          33.2|             44650.36|              39600.0|                   8.1|          8.1|                     11|                     12.9|                     32.0|                            192|                          19.57|                           3.97|  05:54| 18:18|  5/7/2010| 2010-05-07|    5|2010|\n|          2| 5/8/2014|                     63|                   29.3|                   25.1|                    26.7|                         34.8|                         29.4|                          31.4|             44594.75|             33601.31|                  14.6|         14.6|                     13|                     15.5|                     37.4|                            190|                           17.1|                           3.44|  05:54| 18:18|  5/8/2014| 2014-05-08|    5|2014|\n+-----------+---------+-----------------------+-----------------------+-----------------------+------------------------+-----------------------------+-----------------------------+------------------------------+---------------------+---------------------+----------------------+-------------+-----------------------+-------------------------+-------------------------+-------------------------------+-------------------------------+-------------------------------+-------+------+----------+-----------+-----+----+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1696",
              "$$hashKey": "object:1013803"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765124511215_1853189283",
      "id": "paragraph_1765124511215_1853189283",
      "dateCreated": "2025-12-07T16:21:51+0000",
      "dateStarted": "2025-12-17T19:20:48+0000",
      "dateFinished": "2025-12-17T19:20:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013358"
    },
    {
      "text": "%pyspark\n#Missing Value Check",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:49+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123750720_1511465319",
      "id": "paragraph_1765123750720_1511465319",
      "dateCreated": "2025-12-07T16:09:10+0000",
      "dateStarted": "2025-12-17T19:20:49+0000",
      "dateFinished": "2025-12-17T19:20:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013359"
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.functions import col, sum\n\nmay_df.select([\n    sum(col(c).isNull().cast(\"int\")).alias(c+\"_nulls\") for c in may_df.columns\n]).show()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:49+0000",
      "progress": 79,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+----------+-----------------------------+-----------------------------+-----------------------------+------------------------------+-----------------------------------+-----------------------------------+------------------------------------+---------------------------+---------------------------+----------------------------+-------------------+-----------------------------+-------------------------------+-------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------+------------+----------------+-----------------+-----------+----------+\n|location_id_nulls|date_nulls|weather_code (wmo code)_nulls|temperature_2m_max (°C)_nulls|temperature_2m_min (°C)_nulls|temperature_2m_mean (°C)_nulls|apparent_temperature_max (°C)_nulls|apparent_temperature_min (°C)_nulls|apparent_temperature_mean (°C)_nulls|daylight_duration (s)_nulls|sunshine_duration (s)_nulls|precipitation_sum (mm)_nulls|rain_sum (mm)_nulls|precipitation_hours (h)_nulls|wind_speed_10m_max (km/h)_nulls|wind_gusts_10m_max (km/h)_nulls|wind_direction_10m_dominant (°)_nulls|shortwave_radiation_sum (MJ/m²)_nulls|et0_fao_evapotranspiration (mm)_nulls|sunrise_nulls|sunset_nulls|date_clean_nulls|date_parsed_nulls|month_nulls|year_nulls|\n+-----------------+----------+-----------------------------+-----------------------------+-----------------------------+------------------------------+-----------------------------------+-----------------------------------+------------------------------------+---------------------------+---------------------------+----------------------------+-------------------+-----------------------------+-------------------------------+-------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------+------------+----------------+-----------------+-----------+----------+\n|                0|         0|                            0|                            0|                            0|                             0|                                  0|                                  0|                                   0|                          0|                          0|                           0|                  0|                            0|                              0|                              0|                                    0|                                    0|                                    0|            0|           0|               0|                0|          0|         0|\n+-----------------+----------+-----------------------------+-----------------------------+-----------------------------+------------------------------+-----------------------------------+-----------------------------------+------------------------------------+---------------------------+---------------------------+----------------------------+-------------------+-----------------------------+-------------------------------+-------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------+------------+----------------+-----------------+-----------+----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1697",
              "$$hashKey": "object:1013829"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765165614664_987723184",
      "id": "paragraph_1765165614664_987723184",
      "dateCreated": "2025-12-08T03:46:54+0000",
      "dateStarted": "2025-12-17T19:20:49+0000",
      "dateFinished": "2025-12-17T19:20:50+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013360"
    },
    {
      "text": "%pyspark\n#Select required columns",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:50+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765165750744_1412866773",
      "id": "paragraph_1765165750744_1412866773",
      "dateCreated": "2025-12-08T03:49:10+0000",
      "dateStarted": "2025-12-17T19:20:50+0000",
      "dateFinished": "2025-12-17T19:20:51+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013361"
    },
    {
      "text": "%pyspark\nclean_df = may_df.select(\n    col(\"precipitation_hours (h)\").alias(\"precipitation_hours\"),\n    col(\"sunshine_duration (s)\").alias(\"sunshine_duration\"),\n    col(\"wind_speed_10m_max (km/h)\").alias(\"wind_speed_10m_max\"),\n    col(\"et0_fao_evapotranspiration (mm)\").alias(\"evapotranspiration\")\n).na.drop()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123634082_984682113",
      "id": "paragraph_1765123634082_984682113",
      "dateCreated": "2025-12-07T16:07:14+0000",
      "dateStarted": "2025-12-17T19:20:51+0000",
      "dateFinished": "2025-12-17T19:20:51+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013362"
    },
    {
      "text": "%pyspark\nclean_df = clean_df.filter(\n    (clean_df.precipitation_hours >= 0) &\n    (clean_df.sunshine_duration >= 0) &\n    (clean_df.wind_speed_10m_max >= 0) &\n    (clean_df.evapotranspiration >= 0)\n)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765171659843_1724244613",
      "id": "paragraph_1765171659843_1724244613",
      "dateCreated": "2025-12-08T05:27:39+0000",
      "dateStarted": "2025-12-17T19:20:51+0000",
      "dateFinished": "2025-12-17T19:20:51+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013363"
    },
    {
      "text": "%pyspark\n#Data Type Casting",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765165590870_1609600613",
      "id": "paragraph_1765165590870_1609600613",
      "dateCreated": "2025-12-08T03:46:30+0000",
      "dateStarted": "2025-12-17T19:20:51+0000",
      "dateFinished": "2025-12-17T19:20:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013364"
    },
    {
      "text": "%pyspark\nclean_df = clean_df.select(\n    col(\"precipitation_hours\").cast(\"double\"),\n    col(\"sunshine_duration\").cast(\"double\"),\n    col(\"wind_speed_10m_max\").cast(\"double\"),\n    col(\"evapotranspiration\").cast(\"double\")\n)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:52+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765165539127_506655687",
      "id": "paragraph_1765165539127_506655687",
      "dateCreated": "2025-12-08T03:45:39+0000",
      "dateStarted": "2025-12-17T19:20:52+0000",
      "dateFinished": "2025-12-17T19:20:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013365"
    },
    {
      "text": "%pyspark\n#Outlier Removal",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:52+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765165564233_936914978",
      "id": "paragraph_1765165564233_936914978",
      "dateCreated": "2025-12-08T03:46:04+0000",
      "dateStarted": "2025-12-17T19:20:52+0000",
      "dateFinished": "2025-12-17T19:20:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013366"
    },
    {
      "text": "%pyspark\nimport pyspark.sql.functions as F\n\nQ1 = clean_df.approxQuantile(\"evapotranspiration\", [0.25], 0.05)[0]\nQ3 = clean_df.approxQuantile(\"evapotranspiration\", [0.75], 0.05)[0]\nIQR = Q3 - Q1\n\nclean_df = clean_df.filter(\n    (col(\"evapotranspiration\") >= Q1 - 1.5 * IQR) &\n    (col(\"evapotranspiration\") <= Q3 + 1.5 * IQR)\n)\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:52+0000",
      "progress": 50,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1698",
              "$$hashKey": "object:1013895"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1699",
              "$$hashKey": "object:1013896"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765165555934_802267312",
      "id": "paragraph_1765165555934_802267312",
      "dateCreated": "2025-12-08T03:45:55+0000",
      "dateStarted": "2025-12-17T19:20:52+0000",
      "dateFinished": "2025-12-17T19:20:55+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013367"
    },
    {
      "text": "%pyspark\nclean_df.show(5)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:55+0000",
      "progress": 40,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------+-----------------+------------------+------------------+\n|precipitation_hours|sunshine_duration|wind_speed_10m_max|evapotranspiration|\n+-------------------+-----------------+------------------+------------------+\n|               18.0|         35737.93|              17.8|              3.48|\n|               19.0|         11805.73|              15.5|               2.1|\n|                9.0|         32655.86|              13.2|              3.38|\n|               11.0|          39600.0|              12.9|              3.97|\n|               13.0|         33601.31|              15.5|              3.44|\n+-------------------+-----------------+------------------+------------------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1700",
              "$$hashKey": "object:1013915"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765157286880_997954540",
      "id": "paragraph_1765157286880_997954540",
      "dateCreated": "2025-12-08T01:28:06+0000",
      "dateStarted": "2025-12-17T19:20:55+0000",
      "dateFinished": "2025-12-17T19:20:56+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013368"
    },
    {
      "text": "%pyspark\nclean_df.selectExpr(\"min(evapotranspiration)\", \"max(evapotranspiration)\").show()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:56+0000",
      "progress": 96,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------------+-----------------------+\n|min(evapotranspiration)|max(evapotranspiration)|\n+-----------------------+-----------------------+\n|                   1.12|                   7.77|\n+-----------------------+-----------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1701",
              "$$hashKey": "object:1013932"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765998778969_77110778",
      "id": "paragraph_1765998778969_77110778",
      "dateCreated": "2025-12-17T19:12:58+0000",
      "dateStarted": "2025-12-17T19:20:56+0000",
      "dateFinished": "2025-12-17T19:20:58+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013369"
    },
    {
      "text": "%pyspark\n#Feature Engineering – Vector Assembler",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:58+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765124022288_2000302392",
      "id": "paragraph_1765124022288_2000302392",
      "dateCreated": "2025-12-07T16:13:42+0000",
      "dateStarted": "2025-12-17T19:20:58+0000",
      "dateFinished": "2025-12-17T19:20:58+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013370"
    },
    {
      "text": "%pyspark\nassembler = VectorAssembler(\n    inputCols=[\"precipitation_hours\", \"sunshine_duration\", \"wind_speed_10m_max\"],\n    outputCol=\"features\"\n)\n\ndata = assembler.transform(clean_df).select(\n    \"precipitation_hours\",\n    \"sunshine_duration\",\n    \"wind_speed_10m_max\",\n    \"evapotranspiration\",\n    \"features\")",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:59+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123653072_2001912011",
      "id": "paragraph_1765123653072_2001912011",
      "dateCreated": "2025-12-07T16:07:33+0000",
      "dateStarted": "2025-12-17T19:20:59+0000",
      "dateFinished": "2025-12-17T19:20:59+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013371"
    },
    {
      "text": "%pyspark\n#Train/Test Split (80% / 20%)\ntrain_data, test_data = data.randomSplit([0.8, 0.2], seed=42)\n\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:59+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123858619_845777114",
      "id": "paragraph_1765123858619_845777114",
      "dateCreated": "2025-12-07T16:10:58+0000",
      "dateStarted": "2025-12-17T19:20:59+0000",
      "dateFinished": "2025-12-17T19:20:59+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013372"
    },
    {
      "text": "%pyspark\nevaluator = RegressionEvaluator(\n    labelCol=\"evapotranspiration\",\n    predictionCol=\"prediction\",\n    metricName=\"rmse\"\n)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:20:59+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765997446483_76643888",
      "id": "paragraph_1765997446483_76643888",
      "dateCreated": "2025-12-17T18:50:46+0000",
      "dateStarted": "2025-12-17T19:20:59+0000",
      "dateFinished": "2025-12-17T19:21:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013373"
    },
    {
      "text": "%pyspark\n\n\n # Model 1 - Linear Regression\n lr = LinearRegression(\n     featuresCol=\"features\",\n    labelCol=\"evapotranspiration\"\n )\n\n lr_model = lr.fit(train_data)\n\n #Model 2 - Random Forest Regressor\n\n rf = RandomForestRegressor(\n     labelCol=\"evapotranspiration\",\n     featuresCol=\"features\",\n     seed=42\n )\n dt_model = dt.fit(train_data)\n\n #Model 3:  Decision Tree Regressor\n dt = DecisionTreeRegressor(\n     labelCol=\"evapotranspiration\",  \n     featuresCol=\"features\",         \n     seed=42                         \n )\nrf_model = rf.fit(train_data)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:48:58+0000",
      "progress": 20,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1702",
              "$$hashKey": "object:1014206"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1703",
              "$$hashKey": "object:1014207"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1704",
              "$$hashKey": "object:1014208"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1705",
              "$$hashKey": "object:1014209"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1706",
              "$$hashKey": "object:1014210"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1707",
              "$$hashKey": "object:1014211"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1708",
              "$$hashKey": "object:1014212"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1709",
              "$$hashKey": "object:1014213"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1710",
              "$$hashKey": "object:1014214"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1711",
              "$$hashKey": "object:1014215"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1712",
              "$$hashKey": "object:1014216"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1713",
              "$$hashKey": "object:1014217"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1714",
              "$$hashKey": "object:1014218"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1715",
              "$$hashKey": "object:1014219"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1716",
              "$$hashKey": "object:1014220"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1717",
              "$$hashKey": "object:1014221"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1718",
              "$$hashKey": "object:1014222"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1719",
              "$$hashKey": "object:1014223"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1720",
              "$$hashKey": "object:1014224"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1721",
              "$$hashKey": "object:1014225"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1722",
              "$$hashKey": "object:1014226"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1723",
              "$$hashKey": "object:1014227"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123890213_959617222",
      "id": "paragraph_1765123890213_959617222",
      "dateCreated": "2025-12-07T16:11:30+0000",
      "dateStarted": "2025-12-17T19:21:00+0000",
      "dateFinished": "2025-12-17T19:21:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013374"
    },
    {
      "text": "%pyspark\n\ndef evaluate_model(model, name, test_data):\n    predictions = model.transform(test_data)\n    \n    rmse_evaluator = RegressionEvaluator(labelCol=\"evapotranspiration\", predictionCol=\"prediction\", metricName=\"rmse\")\n    mae_evaluator  = RegressionEvaluator(labelCol=\"evapotranspiration\", predictionCol=\"prediction\", metricName=\"mae\")\n    r2_evaluator   = RegressionEvaluator(labelCol=\"evapotranspiration\", predictionCol=\"prediction\", metricName=\"r2\")\n    \n    rmse = rmse_evaluator.evaluate(predictions)\n    mae  = mae_evaluator.evaluate(predictions)\n    r2   = r2_evaluator.evaluate(predictions)\n    \n    return Row(Model=name, RMSE=rmse, MAE=mae, R2=r2)\n\nmodels = [\n    (lr_model, \"Linear Regression\"),\n    (dt_model, \"Decision Tree\"),\n    (rf_model, \"Random Forest\")\n]\n\nresults = [evaluate_model(model, name, test_data) for model, name in models]\n\nresults_df = spark.createDataFrame(results)\nresults_df.show()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:21:23+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------+-----------------+------------------+------------------+\n|                MAE|            Model|                R2|              RMSE|\n+-------------------+-----------------+------------------+------------------+\n|0.41862168709840275|Linear Regression| 0.781298643066006|0.5395545871902544|\n|0.40538859440999675|    Decision Tree|0.7931263969253274|0.5247617716651126|\n|0.38736291410805396|    Random Forest|0.8114371505029712|0.5009999893114112|\n+-------------------+-----------------+------------------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1724",
              "$$hashKey": "object:1014060"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1725",
              "$$hashKey": "object:1014061"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1726",
              "$$hashKey": "object:1014062"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1727",
              "$$hashKey": "object:1014063"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1728",
              "$$hashKey": "object:1014064"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1729",
              "$$hashKey": "object:1014065"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1730",
              "$$hashKey": "object:1014066"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1731",
              "$$hashKey": "object:1014067"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1732",
              "$$hashKey": "object:1014068"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1733",
              "$$hashKey": "object:1014069"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1734",
              "$$hashKey": "object:1014070"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1735",
              "$$hashKey": "object:1014071"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765997082865_665712399",
      "id": "paragraph_1765997082865_665712399",
      "dateCreated": "2025-12-17T18:44:42+0000",
      "dateStarted": "2025-12-17T19:21:23+0000",
      "dateFinished": "2025-12-17T19:21:36+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013375"
    },
    {
      "text": "%pyspark\npredictions_df = rf_model.transform(test_data)\npredictions_df.show(5)\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:21:36+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------+-----------------+------------------+------------------+-------------------+------------------+\n|precipitation_hours|sunshine_duration|wind_speed_10m_max|evapotranspiration|           features|        prediction|\n+-------------------+-----------------+------------------+------------------+-------------------+------------------+\n|                0.0|         38304.52|              22.5|              4.98|[0.0,38304.52,22.5]| 5.455097470349655|\n|                0.0|         38404.53|              10.9|              4.45|[0.0,38404.53,10.9]|  4.76601416202757|\n|                0.0|         39648.86|              25.1|              5.97|[0.0,39648.86,25.1]|5.8527394494948535|\n|                2.0|          39600.0|              14.1|              4.34| [2.0,39600.0,14.1]| 4.753083038585651|\n|                2.0|         41317.54|              26.5|               5.8|[2.0,41317.54,26.5]| 5.526580479029975|\n+-------------------+-----------------+------------------+------------------+-------------------+------------------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1736",
              "$$hashKey": "object:1014110"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765123918682_1221859100",
      "id": "paragraph_1765123918682_1221859100",
      "dateCreated": "2025-12-07T16:11:58+0000",
      "dateStarted": "2025-12-17T19:21:36+0000",
      "dateFinished": "2025-12-17T19:21:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013376"
    },
    {
      "text": "%pyspark\n#Determine Conditions That Lead to Evapotranspiration < 5.5 mm\nlow_pred_df=predictions_df.filter(predictions_df.prediction < 2.5)\nlow_pred_df.show(5)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:53:05+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------+-----------------+------------------+------------------+--------------------+------------------+\n|precipitation_hours|sunshine_duration|wind_speed_10m_max|evapotranspiration|            features|        prediction|\n+-------------------+-----------------+------------------+------------------+--------------------+------------------+\n|               19.0|         11805.73|              15.5|               2.1|[19.0,11805.73,15.5]|2.4181304182530483|\n|               24.0|         11029.43|              17.3|              1.87|[24.0,11029.43,17.3]|2.2670825740555136|\n|               16.0|          4557.47|              14.2|              1.44| [16.0,4557.47,14.2]| 2.408723191018301|\n|               24.0|         11920.71|              13.4|              2.05|[24.0,11920.71,13.4]|2.3231515062793116|\n|               24.0|          5100.06|              11.8|              1.85| [24.0,5100.06,11.8]| 2.277404568016332|\n+-------------------+-----------------+------------------+------------------+--------------------+------------------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1749",
              "$$hashKey": "object:1014748"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1750",
              "$$hashKey": "object:1014749"
            },
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1751",
              "$$hashKey": "object:1014750"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765158072481_445498889",
      "id": "paragraph_1765158072481_445498889",
      "dateCreated": "2025-12-08T01:41:12+0000",
      "dateStarted": "2025-12-17T19:53:05+0000",
      "dateFinished": "2025-12-17T19:53:07+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013377"
    },
    {
      "text": "%pyspark\n\n\nmean_conditions = low_pred_df.agg(\n    F.mean(\"precipitation_hours\").alias(\"mean_precipitation_hours\"),\n    F.mean(\"sunshine_duration\").alias(\"mean_sunshine_duration\"),\n    F.mean(\"wind_speed_10m_max\").alias(\"mean_wind_speed_10m_max\")\n)\n\nmean_conditions.show()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:57:27+0000",
      "progress": 77,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------------------+----------------------+-----------------------+\n|mean_precipitation_hours|mean_sunshine_duration|mean_wind_speed_10m_max|\n+------------------------+----------------------+-----------------------+\n|       20.50632911392405|     6317.069493670885|     17.006329113924057|\n+------------------------+----------------------+-----------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://9f4ab9474c41:4040/jobs/job?id=1752",
              "$$hashKey": "object:1014905"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765158339616_872446684",
      "id": "paragraph_1765158339616_872446684",
      "dateCreated": "2025-12-08T01:45:39+0000",
      "dateStarted": "2025-12-17T19:57:27+0000",
      "dateFinished": "2025-12-17T19:57:29+0000",
      "status": "FINISHED",
      "$$hashKey": "object:1013378"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17T19:57:27+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1766001447924_479366933",
      "id": "paragraph_1766001447924_479366933",
      "dateCreated": "2025-12-17T19:57:27+0000",
      "status": "READY",
      "focus": true,
      "$$hashKey": "object:1014795"
    }
  ],
  "name": "samathi_MLlib",
  "id": "2MAW87UBF",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "isRunning": false
  },
  "path": "/samathi_MLlib"
}